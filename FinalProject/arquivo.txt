patches-own [
  water-level  ; nível de água (enchente)
  is-building? ; se o patch é um prédio
]

to setup
  clear-all
  draw-region
  create-buildings  ; cria prédios entre as ruas
  ask patches [ 
    set water-level 0 
    set is-building? false ; Inicialmente, todos os patches não são prédios
  ]
  start-flood
  reset-ticks
end

to go
  ; Simula o aumento da enchente nas ruas e rodoviária
  ask patches with [ (pcolor = gray or pcolor = red + 2) and not is-building? ] [
    if random-float 1.0 < 0.1 [  ; 10% de chance de aumentar o nível de água
      set water-level water-level + 1
    ]
    if water-level > 0 [
      set pcolor blue + water-level * 0.5
    ]
  ]
  tick
end

to draw-region
  ;; Avenida Plácido Castelo (horizontal - frente da rodoviária)
  ask patches with [ pycor = 5 or pycor = 6 ] [ set pcolor gray ]

  ;; Rua Juscelino Kubitschek (horizontal - atrás da rodoviária)
  ask patches with [ pycor = -5 or pycor = -6 ] [ set pcolor gray ]

  ;; Rua Benigno Bezerra (vertical esquerda)
  ask patches with [ pxcor = -10 or pxcor = -11 ] [ set pcolor gray ]

  ;; Rua José de Queiroz Pessoa (vertical direita)
  ask patches with [ pxcor = 10 or pxcor = 11 ] [ set pcolor gray ]
end

to create-buildings
  ;; Criando prédios entre as ruas (modifique a área conforme necessário)
  ask patches with [
    (pxcor > -3 and pxcor < 3 and pycor > 2 and pycor < 7) or
    (pxcor > -3 and pxcor < 3 and pycor > -7 and pycor < -2) or
    (pxcor > -11 and pxcor < -3 and pycor > -7 and pycor < 7) or
    (pxcor > 3 and pxcor < 11 and pycor > -7 and pycor < 7)
  ] [
    set pcolor gray + 3  ;; Cor dos prédios
    set is-building? true ; Marca como um prédio
  ]
end

to start-flood
  ; Inicia a enchente na parte superior (ex: perto da Av. Plácido Castelo)
  ask patches with [ pxcor >= -3 and pxcor <= 3 and pycor = 6 ] [
    set water-level 1
    set pcolor blue
  ]
end
